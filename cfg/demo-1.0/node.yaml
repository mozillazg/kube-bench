---
controls:
version: "demo-1.0"
id: 2
text: "Worker Node Security Configuration"
type: "node"
groups:
  - id: 2.1
    text: "Worker Node Configuration Files"
    checks:
      - id: 2.1.1
        text: "Ensure that the kubelet service file permissions are set to 644 or more restrictive (Automated)"
        audit: '/bin/sh -c ''if test -e $kubeletsvc; then stat -c permissions=%a $kubeletsvc; fi'' '
        tests:
          test_items:
            - flag: "permissions"
              compare:
                op: bitmask
                value: "644"
        remediation: |
          Run the below command (based on the file location on your system) on the each worker node.
          For example,
          chmod 644 $kubeletsvc
        scored: true
